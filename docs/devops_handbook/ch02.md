# 第二部分 从何开始

## 1 选择合适的价值流作为切入点

**案例**：Nordstrom公司通过选择面向客户的移动端应用、店内餐厅系统和数字化资产进行转型，建立目标（提高发布速度或实现按需发布，拥有更强的迭代能力和客户反馈的响应能力），把测试工作纳入每个人的日常工作。

- 绿地项目与棕地项目：最初来自于城市规划和建设项目，在DevOps中，绿地项目通常是一些试点项目，棕地项目是指那些已经服务客户长达几年甚至几十年的产品或服务。
- 应用的性能取决于架构在当前（或重构后）是否具有可测试性和可部署性。
- 兼顾记录型系统和交互型系统：记录型系统类似于ERP系统，变化速度慢；交互型系统指面向客户或员工的可交互系统（电子商务系统和办公软件），变化速度通常较快。
- 扩大DevOps范围：
    1. 发现创新者和早期采用者：找到志同道合的人
    2. 赢得沉默的大多数：建立更稳固的群众基础
    3. 识别“钉子户”：识别那些高调的、有影响力的反对者

## 2 理解、可视化和运用价值流

**案例**：Nordstram公司通过价值流映射演练，改善化妆业务管理系统（COBOL大型机）应用的请求处理周期，用ipad应用替换了PC应用。

- 确定创造客户价值所需的团队：产品负责人、开发团队、QA团队、运维团队、信息安全团队、发布经理、技术主管或价值流经理
- 针对团队工作绘制价值流：主要识别出阻碍价值流快速流动的环节，重点分析和优化需要等待数周甚至数月的工作、引发或处理重大返工的工作。
- 组建专门的转型团队：
    1. 团队成员的选择：转型团队的成员专门执行DevOps转型工作、选择熟悉多个领域的通才作为团队成员；选择与其他部门长期保持良好关系的人作为团队成员；独立的办公区域，使成员尽可能多地互相交流
    2. 拥有共同的目标：由管理层确定目标和时限
    3. 保持小跨度的改进计划：具备重新计划和更改优先级能力和灵活性，减少工作从实施到生效的延迟时间，从迭代中更快地获取经验，更省力地获得改进，在日常工作中更快地实现有意义的差异化改进，降低项目还没有取得成果被终止的风险。
    4. 为非功能性需求预留20%的开发时间，减少技术债务（Linked的反转行动：用2个月的时间创建一套有助于代码开发的软件和工具，停止新特性开发）
    5. 提高工作的可视化程度
- 用工具强化预期行为：开发人员和运维人员创建共享的工作队列

## 3 参考康威定律设计组织结构

**案例**：Sprouter因为开发团队和数据库团队之间形成紧耦合的依赖关系，阻碍开发人员独立进行开发、测试和部署代码。团队决定将所有业务逻辑从数据库层迁移到应用层，消除由于业务逻辑变更而导致团队的协作问题，减少了工作交接次数，显著提升了生产环境部署的速度和成功率。

- 康威定律：系统设计受限于组织自身的沟通结构，组织的规模越大，灵活性就越差，这种现象也就越明显
- 组织原型：
    1. 职能型组织：以专业技能为中心，运维部门通常采用这种形式
    2. 矩阵型组织：结合职能型和市场型，可能需要被双重领导
    3. 市场型组织：快速响应客户需求，扁平化结构，由多个职能的部门组成，可能存在冗余现象
- 组建以市场为导向的团队：负责特性开发，还需要负责测试、安全、部署和生产环境的运维，可以独立运作。
- 使职能导向有效：依靠自动化的自助服务平台，拥有高度信任的文化
- 将测试、运维和信息安全融入日常工作中：让所有工程师、工程经理和架构师轮流值班，负责他们自己构建的服务的运维工作
- 使团队成员都成为通才：鼓励员工学习，帮助克服学习焦虑和获得相关技能，明确规划职业生涯。

| I型（专家）              | T型（通才）              | E型                                          |
| ------------------------ | ------------------------ | -------------------------------------------- |
| 精通某个领域             | 精通某个领域             | 精通某几个领域                               |
| 其他领域的技能或经验很少 | 拥有很多领域的技能       | 有多个领域的实践经验，执行能力强，能持续创新 |
| 很快遇到瓶颈             | 能突破瓶颈               | 潜力无限                                     |
| 对下游的浪费和影响不敏感 | 对下游的浪费和影响敏感   |                                              |
| 抵制灵活或可变的计划     | 帮助制订灵活和可变的计划 |                                              |
- 创建松耦合架构，提高生产力和安全性：生产环境中可以独立更新某一项服务，而无需更新其他服务。
- 保持小规模团队（两个比萨原则：5~10人）：确保团队成员对系统有清晰、相同的理解；限制正在开发的产品或服务的增长率；分散权力并实现自主；让员工获得领导经验。（吉塔特公司“API启动”项目案例：内部的所有团队都能够方便地获取和存储所需的数据）

## 4 将运维融入日常工作中

**案例**：大鱼游戏公司（Big Fish Games）通过运维联络人模式，将运维专家融入开发团队，建立专职发布工程师，熟悉与产品开发和QA相同的问题，帮助开发团队从运维部门获取支持。

- 创建共享服务，提高开发生产力：运维提供全自动化的平台和服务，按需提供，不需要开发人员提交工单，保证运维不成为客户的瓶颈
- 将运维工程师融入服务团队：工作优先级几乎完全受所在产品团队的目标驱动，而不再专注于解决自己的问题，参加开发团队的相关讨论，随着开发团队对运维知识和能力的需求逐渐降低，运维工程师可以转移到其他的项目或工作中。
- 为每个服务团队分派运维联络人：派遣的运维工程师的责任如下：
    1. 新产品的功能是什么，为什么要开发这个产品；
    2. 它是怎样工作的，可运维性如何，可扩展性和监控能力如何（强烈建议以图示说明）；
    3. 怎样监控和收集指标，如何确认应用的功能正常
    4. 架构和模式是否与以往的做法不同，这样做的理由是什么
    5. 是否对基础设施有额外的需求，它的使用对基础设施容量的影响如何
    6. 特性的发布计划
- 邀请运维工程师参加开发团队的会议：
    1. 每日站会：在整个团队范围内分享信息，同时了解所有正在做和将要完成的工作
    2. 回顾会议：帮助产品团队认识和理解自己所做出的决策对下游团队的影响
- 使用看板图展示运维工作
