# 第一部分 DevOps介绍 

## 1 敏捷、持续交付和三步法

### 1.1 精益理论

- 价值流：一个组织基于客户的需求所执行的一系列有序的交付活动，或者为了给客户设计、生产和提供产品或服务所需从事的一系列活动，它包括了信息流和物料流的双重价值
- 前置时间：在工单创建后开始计时，到工作完成时结束
- 处理时间：从实际开始处理这个工作时开始计时，不包括这个工作在队列中排队等待的时间
- 分钟级别的部署前置时间：通过向版本控制系统中持续不断地提交小批量的代码变更，并对代码做自动化测试和探索测试，然后再将它部署到生产环境中。
- %C/A：完成时间和精确的总花费时间的百分比，反映了价值流中的每个步骤的输出质量。

### 1.2 三步工作法：DevOps的基本原则

- 第一步：实现开发到运维的工作快速地从左向右流动。加快技术价值流的流动，缩短前置时间，相关的实践包括持续构建、集成、测试和部署。
- 第二步：在从右向左的每个阶段中，应用持续、快速的工作反馈机制。通过放大反馈环，防止问题复发，缩短问题检测周期，实现快速修复。
- 第三步：建立具有创意和高可信度的企业文化，支持动态的、严格的、科学的实验。技术价值流的核心是建立高度信任的文化。

## 2 第一步：流动原则

- 通过可视化工作板使工作可见
- 限制多任务的出现，控制队列的长度
- 减小批量大小
- 减小交接次数，避免信息或知识在交接过程中的丢失
- 持续识别和改善约束点：
    1. 识别系统的约束点
    2. 决定如何利用这个系统的约束点
    3. 基于上述决定，考虑全局工作
    4. 改善系统的约束点
    5. 如果约束点已经突破，回到第1步，杜绝惯性导致的系统约束
- 消除价值流中的困境和浪费：主要包括半成品（还没有彻底完成的工作）、额外工序（在交付过程中执行的、并为给客户增值的额外工作）、额外功能、任务切换、等待、移动（信息或数据在工作中心之间移动的工作量）、缺陷、非标准或手动操作、填坑侠

## 3 第二步：反馈原则

- 复杂系统的特点：
    1. 无法将系统视为一个整体，去理解各个部分是如何组成在一起的
    2. 相同的事情做两次，结果未必相同
- 及时发现问题：度量和监控信息流中的每个工序，快速发现和处理任何缺陷或严重偏差，建立全访问的监控系统，监控服务组件在生产环境中的运行状态，快速探测到服务的意外情况。
- 群策群力解决问题，快速地构建新知识：遏制住问题，防止蔓延，定位和处理问题，避免复发。防止把问题带入下游的处理环节，避免技术债的延申；防止引入新的错误到新的工作中；如果问题没有得到解决，可能会需要更高的修复成本。
- 从源头保障质量：在日常工作中，需要价值流中的每个人在他们的控制领域里发现并解决问题。

## 4 第三步：持续学习与实验原则

- 三种类型的文化：病态型、官僚型、生机型

|     病态型     |        官僚型        |     生机型     |
| :------------: | :------------------: | :------------: |
|    隐瞒信息    |       忽略信息       |  积极探索信息  |
|    消灭信使    |      不重视信使      |    训练信使    |
|    逃避责任    |       各自担责       |    共担责任    |
| 阻碍团队的互动 |    容忍团队的互动    | 鼓励团队间结盟 |
|    隐瞒事故    |  组织是公道和宽容的  |  调查事故根因  |
|   压制新想法   | 认为新想法会造成麻烦 |   接纳新想法   |

- 将日常工作的改进制度化：通过明确预留时间来改善日常工作，包括预留时间来偿还技术债、修复缺陷、重构、优化代码和环境，安排改善闪电战时段，让工程师通过自组团队的方式来解决他们感兴趣的问题。
- 把局部发现转化为全局优化：把隐性知识转换为显性知识，帮助其他人吸取专业知识并在实践中应用。
- 在日常工作中注入弹性模式：通过加压来增加弹性，在技术价值流中，通过缩短部署的前置时间、提高测试覆盖率、缩短测试执行时间，在必要时解耦架构等引入张力的方式
- 领导层强化学习文化：帮助一线工作者在日常工作中发现并解决问题，是学习型组织、改善套路和高可靠性组织的核心